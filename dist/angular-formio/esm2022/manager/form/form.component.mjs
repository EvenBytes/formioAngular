import { Component } from '@angular/core';
import * as i0 from "@angular/core";
import * as i1 from "../form-manager.service";
import * as i2 from "@angular/router";
import * as i3 from "@formio/angular";
import * as i4 from "../form-manager.config";
import * as i5 from "ngx-bootstrap/modal";
import * as i6 from "@angular/common";
import * as i7 from "@angular/forms";
class FormManagerFormComponent {
    service;
    route;
    appConfig;
    options;
    modalService;
    choice = 'isUrl';
    embedCode;
    shareUrl;
    projectId;
    pathName;
    goTo = '';
    modalRef;
    constructor(service, route, appConfig, options, modalService) {
        this.service = service;
        this.route = route;
        this.appConfig = appConfig;
        this.options = options;
        this.modalService = modalService;
    }
    ngOnInit() {
        this.service.reset(this.route);
        this.service.loadForm().then(form => {
            this.service.formSrc = this.appConfig.appUrl + '/' + form.path;
            this.projectId = form.project;
            this.pathName = form.path;
            this.getShareUrl();
        });
    }
    getShareUrl() {
        const src = this.appConfig.appUrl + '/' + this.pathName;
        this.shareUrl = `${this.options.viewer}/#/?src=${encodeURIComponent(src)}`;
        return this.shareUrl;
    }
    openEmbed(content) {
        let goto = '';
        if (this.goTo) {
            goto += `if (d && d.formSubmission && d.formSubmission._id) { window.location.href = "${this.goTo}";}`;
        }
        let embedCode = '<script type="text/javascript">';
        embedCode += '(function a(d, w, u) {';
        embedCode += 'var h = d.getElementsByTagName("head")[0];';
        embedCode += 'var s = d.createElement("script");';
        embedCode += 's.type = "text/javascript";';
        embedCode += 's.src = "' + this.options.viewer + '/assets/lib/seamless/seamless.parent.min.js";';
        embedCode += 's.onload = function b() {';
        embedCode += 'var f = d.getElementById("formio-form-' + this.service.formio.formId + '");';
        embedCode += 'if (!f || (typeof w.seamless === u)) {';
        embedCode += 'return setTimeout(b, 100);';
        embedCode += '}';
        embedCode += 'w.seamless(f, {fallback:false}).receive(function(d, e) {' + goto + '});';
        embedCode += '};';
        embedCode += 'h.appendChild(s);';
        embedCode += '})(document, window);';
        embedCode += '</script>';
        embedCode += '<iframe id="formio-form-' + this.service.formio.formId + '" ';
        embedCode += 'style="width:100%;border:none;" height="800px" src="' + this.shareUrl + '&iframe=1"></iframe>';
        this.embedCode = embedCode;
        this.modalRef = this.modalService.show(content, { class: 'modal-lg' });
    }
    choices(string) {
        this.choice = string;
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.0.4", ngImport: i0, type: FormManagerFormComponent, deps: [{ token: i1.FormManagerService }, { token: i2.ActivatedRoute }, { token: i3.FormioAppConfig }, { token: i4.FormManagerConfig }, { token: i5.BsModalService }], target: i0.ɵɵFactoryTarget.Component });
    static ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.0.4", type: FormManagerFormComponent, selector: "ng-component", ngImport: i0, template: "<button *ngIf=\"options.viewer\" class=\"float-end btn btn-outline-primary\" (click)=\"openEmbed(content)\"><em class=\"fa fa-share-alt bi bi-share\"></em> Share</button>\r\n<ul class=\"nav nav-tabs mb-2\">\r\n  <li class=\"nav-item\"><a class=\"nav-link\" routerLink=\"../\"><em class=\"fa fa-chevron-left bi bi-chevron-left\"></em></a></li>\r\n  <li class=\"nav-item\" routerLinkActive=\"active\"><a class=\"nav-link\" routerLink=\"view\" routerLinkActive=\"active\"><em class=\"fa fa-pencil bi bi-pencil\"></em> Enter Data</a></li>\r\n  <li class=\"nav-item\" routerLinkActive=\"active\"><a class=\"nav-link\" routerLink=\"submission\" routerLinkActive=\"active\"><em class=\"fa fa-list-alt bi bi-table\"></em> View Data</a></li>\r\n  <li *ngIf=\"service.actionAllowed('formEdit')\" class=\"nav-item\" routerLinkActive=\"active\"><a class=\"nav-link\" routerLink=\"edit\" routerLinkActive=\"active\"><em class=\"fa fa-edit bi bi-pencil-square\"></em> Edit Form</a></li>\r\n  <li *ngIf=\"service.actionAllowed('formDelete')\" class=\"nav-item\" routerLinkActive=\"active\"><a class=\"nav-link\" routerLink=\"delete\" routerLinkActive=\"active\"><span class=\"fa fa-trash bi bi-trash\"></span></a></li>\r\n</ul>\r\n<router-outlet></router-outlet>\r\n<ng-template #content>\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">Share or Embed this form</h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"modalRef.hide()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <ul class=\"nav nav-tabs mr-auto mb-2\">\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" [ngClass]=\"{'active': choice === 'isUrl'}\" (click)=\"choices('isUrl')\"><em class=\"fa fa-link bi bi-link\"></em> URL</a>\r\n      </li>\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" [ngClass]=\"{'active': choice === 'isEmbed'}\" (click)=\"choices('isEmbed')\"><em class=\"fa fa-code bi bi-code-slash\"></em> Embed</a>\r\n      </li>\r\n    </ul>\r\n    <pre  *ngIf=\"choice === 'isEmbed'\"><textarea onclick=\"this.focus();this.select()\" readonly=\"readonly\" style=\"width:100%;\" rows=\"8\" [ngModel]=\"embedCode\"></textarea></pre>\r\n    <input *ngIf=\"choice === 'isUrl'\" type=\"text\" onclick=\"this.focus();this.select()\" readonly=\"readonly\" class=\"form-control\" [ngModel]=\"shareUrl\" placeholder=\"https://examples.form.io/example\">\r\n  </div>\r\n  <div class=\"modal-footer\">\r\n    <button type=\"button\" class=\"btn btn-light\" (click)=\"modalRef.hide()\">Close</button>\r\n  </div>\r\n</ng-template>\r\n", dependencies: [{ kind: "directive", type: i6.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: i6.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i2.RouterOutlet, selector: "router-outlet", inputs: ["name"], outputs: ["activate", "deactivate", "attach", "detach"], exportAs: ["outlet"] }, { kind: "directive", type: i2.RouterLink, selector: "[routerLink]", inputs: ["target", "queryParams", "fragment", "queryParamsHandling", "state", "relativeTo", "preserveFragment", "skipLocationChange", "replaceUrl", "routerLink"] }, { kind: "directive", type: i2.RouterLinkActive, selector: "[routerLinkActive]", inputs: ["routerLinkActiveOptions", "ariaCurrentWhenActive", "routerLinkActive"], outputs: ["isActiveChange"], exportAs: ["routerLinkActive"] }, { kind: "directive", type: i7.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i7.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i7.NgModel, selector: "[ngModel]:not([formControlName]):not([formControl])", inputs: ["name", "disabled", "ngModel", "ngModelOptions"], outputs: ["ngModelChange"], exportAs: ["ngModel"] }] });
}
export { FormManagerFormComponent };
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.0.4", ngImport: i0, type: FormManagerFormComponent, decorators: [{
            type: Component,
            args: [{ template: "<button *ngIf=\"options.viewer\" class=\"float-end btn btn-outline-primary\" (click)=\"openEmbed(content)\"><em class=\"fa fa-share-alt bi bi-share\"></em> Share</button>\r\n<ul class=\"nav nav-tabs mb-2\">\r\n  <li class=\"nav-item\"><a class=\"nav-link\" routerLink=\"../\"><em class=\"fa fa-chevron-left bi bi-chevron-left\"></em></a></li>\r\n  <li class=\"nav-item\" routerLinkActive=\"active\"><a class=\"nav-link\" routerLink=\"view\" routerLinkActive=\"active\"><em class=\"fa fa-pencil bi bi-pencil\"></em> Enter Data</a></li>\r\n  <li class=\"nav-item\" routerLinkActive=\"active\"><a class=\"nav-link\" routerLink=\"submission\" routerLinkActive=\"active\"><em class=\"fa fa-list-alt bi bi-table\"></em> View Data</a></li>\r\n  <li *ngIf=\"service.actionAllowed('formEdit')\" class=\"nav-item\" routerLinkActive=\"active\"><a class=\"nav-link\" routerLink=\"edit\" routerLinkActive=\"active\"><em class=\"fa fa-edit bi bi-pencil-square\"></em> Edit Form</a></li>\r\n  <li *ngIf=\"service.actionAllowed('formDelete')\" class=\"nav-item\" routerLinkActive=\"active\"><a class=\"nav-link\" routerLink=\"delete\" routerLinkActive=\"active\"><span class=\"fa fa-trash bi bi-trash\"></span></a></li>\r\n</ul>\r\n<router-outlet></router-outlet>\r\n<ng-template #content>\r\n  <div class=\"modal-header\">\r\n    <h4 class=\"modal-title\">Share or Embed this form</h4>\r\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" (click)=\"modalRef.hide()\">\r\n      <span aria-hidden=\"true\">&times;</span>\r\n    </button>\r\n  </div>\r\n  <div class=\"modal-body\">\r\n    <ul class=\"nav nav-tabs mr-auto mb-2\">\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" [ngClass]=\"{'active': choice === 'isUrl'}\" (click)=\"choices('isUrl')\"><em class=\"fa fa-link bi bi-link\"></em> URL</a>\r\n      </li>\r\n      <li class=\"nav-item\">\r\n        <a class=\"nav-link\" [ngClass]=\"{'active': choice === 'isEmbed'}\" (click)=\"choices('isEmbed')\"><em class=\"fa fa-code bi bi-code-slash\"></em> Embed</a>\r\n      </li>\r\n    </ul>\r\n    <pre  *ngIf=\"choice === 'isEmbed'\"><textarea onclick=\"this.focus();this.select()\" readonly=\"readonly\" style=\"width:100%;\" rows=\"8\" [ngModel]=\"embedCode\"></textarea></pre>\r\n    <input *ngIf=\"choice === 'isUrl'\" type=\"text\" onclick=\"this.focus();this.select()\" readonly=\"readonly\" class=\"form-control\" [ngModel]=\"shareUrl\" placeholder=\"https://examples.form.io/example\">\r\n  </div>\r\n  <div class=\"modal-footer\">\r\n    <button type=\"button\" class=\"btn btn-light\" (click)=\"modalRef.hide()\">Close</button>\r\n  </div>\r\n</ng-template>\r\n" }]
        }], ctorParameters: function () { return [{ type: i1.FormManagerService }, { type: i2.ActivatedRoute }, { type: i3.FormioAppConfig }, { type: i4.FormManagerConfig }, { type: i5.BsModalService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9hbmd1bGFyLWZvcm1pby9tYW5hZ2VyL3NyYy9mb3JtL2Zvcm0uY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvYW5ndWxhci1mb3JtaW8vbWFuYWdlci9zcmMvZm9ybS9mb3JtLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQXVCLE1BQU0sZUFBZSxDQUFDOzs7Ozs7Ozs7QUFPL0QsTUFHYSx3QkFBd0I7SUFTMUI7SUFDQTtJQUNBO0lBQ0E7SUFDQztJQVpWLE1BQU0sR0FBUSxPQUFPLENBQUM7SUFDdEIsU0FBUyxDQUFNO0lBQ2YsUUFBUSxDQUFNO0lBQ2QsU0FBUyxDQUFNO0lBQ2YsUUFBUSxDQUFNO0lBQ2QsSUFBSSxHQUFRLEVBQUUsQ0FBQztJQUNmLFFBQVEsQ0FBYTtJQUNyQixZQUNTLE9BQTJCLEVBQzNCLEtBQXFCLEVBQ3JCLFNBQTBCLEVBQzFCLE9BQTBCLEVBQ3pCLFlBQTRCO1FBSjdCLFlBQU8sR0FBUCxPQUFPLENBQW9CO1FBQzNCLFVBQUssR0FBTCxLQUFLLENBQWdCO1FBQ3JCLGNBQVMsR0FBVCxTQUFTLENBQWlCO1FBQzFCLFlBQU8sR0FBUCxPQUFPLENBQW1CO1FBQ3pCLGlCQUFZLEdBQVosWUFBWSxDQUFnQjtJQUNsQyxDQUFDO0lBRUwsUUFBUTtRQUNOLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMvQixJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUNsQyxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQztZQUMvRCxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUM7WUFDOUIsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1lBQzFCLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNyQixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFTSxXQUFXO1FBQ2hCLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO1FBQ3hELElBQUksQ0FBQyxRQUFRLEdBQUcsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sV0FBVyxrQkFBa0IsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDO1FBQzNFLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQztJQUN2QixDQUFDO0lBRUQsU0FBUyxDQUFDLE9BQXlCO1FBQ2pDLElBQUksSUFBSSxHQUFHLEVBQUUsQ0FBQztRQUNkLElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtZQUNiLElBQUksSUFBSSxnRkFBZ0YsSUFBSSxDQUFDLElBQUksS0FBSyxDQUFDO1NBQ3hHO1FBQ0QsSUFBSSxTQUFTLEdBQUcsaUNBQWlDLENBQUM7UUFDbEQsU0FBUyxJQUFJLHdCQUF3QixDQUFDO1FBQ3RDLFNBQVMsSUFBTyw0Q0FBNEMsQ0FBQztRQUM3RCxTQUFTLElBQU8sb0NBQW9DLENBQUM7UUFDckQsU0FBUyxJQUFPLDZCQUE2QixDQUFDO1FBQzlDLFNBQVMsSUFBTyxXQUFXLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEdBQUcsK0NBQStDLENBQUM7UUFDcEcsU0FBUyxJQUFPLDJCQUEyQixDQUFDO1FBQzVDLFNBQVMsSUFBVSx3Q0FBd0MsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO1FBQ2pHLFNBQVMsSUFBVSx3Q0FBd0MsQ0FBQztRQUM1RCxTQUFTLElBQWEsNEJBQTRCLENBQUM7UUFDbkQsU0FBUyxJQUFVLEdBQUcsQ0FBQztRQUN2QixTQUFTLElBQVUsMERBQTBELEdBQUcsSUFBSSxHQUFHLEtBQUssQ0FBQztRQUM3RixTQUFTLElBQU8sSUFBSSxDQUFDO1FBQ3JCLFNBQVMsSUFBTyxtQkFBbUIsQ0FBQztRQUNwQyxTQUFTLElBQUksdUJBQXVCLENBQUM7UUFDckMsU0FBUyxJQUFJLFdBQVcsQ0FBQztRQUN6QixTQUFTLElBQUksMEJBQTBCLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztRQUM1RSxTQUFTLElBQVEsc0RBQXNELEdBQUcsSUFBSSxDQUFDLFFBQVEsR0FBRyxzQkFBc0IsQ0FBQztRQUNqSCxJQUFJLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQztRQUMzQixJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsQ0FBQyxDQUFDO0lBQ3pFLENBQUM7SUFFRCxPQUFPLENBQUMsTUFBTTtRQUNaLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO0lBQ3ZCLENBQUM7dUdBN0RVLHdCQUF3QjsyRkFBeEIsd0JBQXdCLG9EQ1ZyQyxzbEZBZ0NBOztTRHRCYSx3QkFBd0I7MkZBQXhCLHdCQUF3QjtrQkFIcEMsU0FBUyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBUZW1wbGF0ZVJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBGb3JtTWFuYWdlclNlcnZpY2UgfSBmcm9tICcuLi9mb3JtLW1hbmFnZXIuc2VydmljZSc7XHJcbmltcG9ydCB7IEZvcm1NYW5hZ2VyQ29uZmlnIH0gZnJvbSAnLi4vZm9ybS1tYW5hZ2VyLmNvbmZpZyc7XHJcbmltcG9ydCB7IEFjdGl2YXRlZFJvdXRlIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcclxuaW1wb3J0IHsgRm9ybWlvQXBwQ29uZmlnIH0gZnJvbSAnQGZvcm1pby9hbmd1bGFyJztcclxuaW1wb3J0IHsgQnNNb2RhbFNlcnZpY2UsIEJzTW9kYWxSZWYgfSBmcm9tICduZ3gtYm9vdHN0cmFwL21vZGFsJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHRlbXBsYXRlVXJsOiAnLi9mb3JtLmNvbXBvbmVudC5odG1sJ1xyXG59KVxyXG5leHBvcnQgY2xhc3MgRm9ybU1hbmFnZXJGb3JtQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuICBjaG9pY2U6IGFueSA9ICdpc1VybCc7XHJcbiAgZW1iZWRDb2RlOiBhbnk7XHJcbiAgc2hhcmVVcmw6IGFueTtcclxuICBwcm9qZWN0SWQ6IGFueTtcclxuICBwYXRoTmFtZTogYW55O1xyXG4gIGdvVG86IGFueSA9ICcnO1xyXG4gIG1vZGFsUmVmOiBCc01vZGFsUmVmO1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIHNlcnZpY2U6IEZvcm1NYW5hZ2VyU2VydmljZSxcclxuICAgIHB1YmxpYyByb3V0ZTogQWN0aXZhdGVkUm91dGUsXHJcbiAgICBwdWJsaWMgYXBwQ29uZmlnOiBGb3JtaW9BcHBDb25maWcsXHJcbiAgICBwdWJsaWMgb3B0aW9uczogRm9ybU1hbmFnZXJDb25maWcsXHJcbiAgICBwcml2YXRlIG1vZGFsU2VydmljZTogQnNNb2RhbFNlcnZpY2VcclxuICApIHsgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMuc2VydmljZS5yZXNldCh0aGlzLnJvdXRlKTtcclxuICAgIHRoaXMuc2VydmljZS5sb2FkRm9ybSgpLnRoZW4oZm9ybSA9PiB7XHJcbiAgICAgIHRoaXMuc2VydmljZS5mb3JtU3JjID0gdGhpcy5hcHBDb25maWcuYXBwVXJsICsgJy8nICsgZm9ybS5wYXRoO1xyXG4gICAgICB0aGlzLnByb2plY3RJZCA9IGZvcm0ucHJvamVjdDtcclxuICAgICAgdGhpcy5wYXRoTmFtZSA9IGZvcm0ucGF0aDtcclxuICAgICAgdGhpcy5nZXRTaGFyZVVybCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0U2hhcmVVcmwoKSB7XHJcbiAgICBjb25zdCBzcmMgPSB0aGlzLmFwcENvbmZpZy5hcHBVcmwgKyAnLycgKyB0aGlzLnBhdGhOYW1lO1xyXG4gICAgdGhpcy5zaGFyZVVybCA9IGAke3RoaXMub3B0aW9ucy52aWV3ZXJ9LyMvP3NyYz0ke2VuY29kZVVSSUNvbXBvbmVudChzcmMpfWA7XHJcbiAgICByZXR1cm4gdGhpcy5zaGFyZVVybDtcclxuICB9XHJcblxyXG4gIG9wZW5FbWJlZChjb250ZW50OiBUZW1wbGF0ZVJlZjxhbnk+KSB7XHJcbiAgICBsZXQgZ290byA9ICcnO1xyXG4gICAgaWYgKHRoaXMuZ29Ubykge1xyXG4gICAgICBnb3RvICs9IGBpZiAoZCAmJiBkLmZvcm1TdWJtaXNzaW9uICYmIGQuZm9ybVN1Ym1pc3Npb24uX2lkKSB7IHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gXCIke3RoaXMuZ29Ub31cIjt9YDtcclxuICAgIH1cclxuICAgIGxldCBlbWJlZENvZGUgPSAnPHNjcmlwdCB0eXBlPVwidGV4dC9qYXZhc2NyaXB0XCI+JztcclxuICAgIGVtYmVkQ29kZSArPSAnKGZ1bmN0aW9uIGEoZCwgdywgdSkgeyc7XHJcbiAgICBlbWJlZENvZGUgKz0gICAgJ3ZhciBoID0gZC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF07JztcclxuICAgIGVtYmVkQ29kZSArPSAgICAndmFyIHMgPSBkLmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7JztcclxuICAgIGVtYmVkQ29kZSArPSAgICAncy50eXBlID0gXCJ0ZXh0L2phdmFzY3JpcHRcIjsnO1xyXG4gICAgZW1iZWRDb2RlICs9ICAgICdzLnNyYyA9IFwiJyArIHRoaXMub3B0aW9ucy52aWV3ZXIgKyAnL2Fzc2V0cy9saWIvc2VhbWxlc3Mvc2VhbWxlc3MucGFyZW50Lm1pbi5qc1wiOyc7XHJcbiAgICBlbWJlZENvZGUgKz0gICAgJ3Mub25sb2FkID0gZnVuY3Rpb24gYigpIHsnO1xyXG4gICAgZW1iZWRDb2RlICs9ICAgICAgICd2YXIgZiA9IGQuZ2V0RWxlbWVudEJ5SWQoXCJmb3JtaW8tZm9ybS0nICsgdGhpcy5zZXJ2aWNlLmZvcm1pby5mb3JtSWQgKyAnXCIpOyc7XHJcbiAgICBlbWJlZENvZGUgKz0gICAgICAgJ2lmICghZiB8fCAodHlwZW9mIHcuc2VhbWxlc3MgPT09IHUpKSB7JztcclxuICAgIGVtYmVkQ29kZSArPSAgICAgICAgICAncmV0dXJuIHNldFRpbWVvdXQoYiwgMTAwKTsnO1xyXG4gICAgZW1iZWRDb2RlICs9ICAgICAgICd9JztcclxuICAgIGVtYmVkQ29kZSArPSAgICAgICAndy5zZWFtbGVzcyhmLCB7ZmFsbGJhY2s6ZmFsc2V9KS5yZWNlaXZlKGZ1bmN0aW9uKGQsIGUpIHsnICsgZ290byArICd9KTsnO1xyXG4gICAgZW1iZWRDb2RlICs9ICAgICd9Oyc7XHJcbiAgICBlbWJlZENvZGUgKz0gICAgJ2guYXBwZW5kQ2hpbGQocyk7JztcclxuICAgIGVtYmVkQ29kZSArPSAnfSkoZG9jdW1lbnQsIHdpbmRvdyk7JztcclxuICAgIGVtYmVkQ29kZSArPSAnPC9zY3JpcHQ+JztcclxuICAgIGVtYmVkQ29kZSArPSAnPGlmcmFtZSBpZD1cImZvcm1pby1mb3JtLScgKyB0aGlzLnNlcnZpY2UuZm9ybWlvLmZvcm1JZCArICdcIiAnO1xyXG4gICAgZW1iZWRDb2RlICs9ICAgICAnc3R5bGU9XCJ3aWR0aDoxMDAlO2JvcmRlcjpub25lO1wiIGhlaWdodD1cIjgwMHB4XCIgc3JjPVwiJyArIHRoaXMuc2hhcmVVcmwgKyAnJmlmcmFtZT0xXCI+PC9pZnJhbWU+JztcclxuICAgIHRoaXMuZW1iZWRDb2RlID0gZW1iZWRDb2RlO1xyXG4gICAgdGhpcy5tb2RhbFJlZiA9IHRoaXMubW9kYWxTZXJ2aWNlLnNob3coY29udGVudCwgeyBjbGFzczogJ21vZGFsLWxnJyB9KTtcclxuICB9XHJcblxyXG4gIGNob2ljZXMoc3RyaW5nKSB7XHJcbiAgICB0aGlzLmNob2ljZSA9IHN0cmluZztcclxuICB9XHJcbn1cclxuIiwiPGJ1dHRvbiAqbmdJZj1cIm9wdGlvbnMudmlld2VyXCIgY2xhc3M9XCJmbG9hdC1lbmQgYnRuIGJ0bi1vdXRsaW5lLXByaW1hcnlcIiAoY2xpY2spPVwib3BlbkVtYmVkKGNvbnRlbnQpXCI+PGVtIGNsYXNzPVwiZmEgZmEtc2hhcmUtYWx0IGJpIGJpLXNoYXJlXCI+PC9lbT4gU2hhcmU8L2J1dHRvbj5cclxuPHVsIGNsYXNzPVwibmF2IG5hdi10YWJzIG1iLTJcIj5cclxuICA8bGkgY2xhc3M9XCJuYXYtaXRlbVwiPjxhIGNsYXNzPVwibmF2LWxpbmtcIiByb3V0ZXJMaW5rPVwiLi4vXCI+PGVtIGNsYXNzPVwiZmEgZmEtY2hldnJvbi1sZWZ0IGJpIGJpLWNoZXZyb24tbGVmdFwiPjwvZW0+PC9hPjwvbGk+XHJcbiAgPGxpIGNsYXNzPVwibmF2LWl0ZW1cIiByb3V0ZXJMaW5rQWN0aXZlPVwiYWN0aXZlXCI+PGEgY2xhc3M9XCJuYXYtbGlua1wiIHJvdXRlckxpbms9XCJ2aWV3XCIgcm91dGVyTGlua0FjdGl2ZT1cImFjdGl2ZVwiPjxlbSBjbGFzcz1cImZhIGZhLXBlbmNpbCBiaSBiaS1wZW5jaWxcIj48L2VtPiBFbnRlciBEYXRhPC9hPjwvbGk+XHJcbiAgPGxpIGNsYXNzPVwibmF2LWl0ZW1cIiByb3V0ZXJMaW5rQWN0aXZlPVwiYWN0aXZlXCI+PGEgY2xhc3M9XCJuYXYtbGlua1wiIHJvdXRlckxpbms9XCJzdWJtaXNzaW9uXCIgcm91dGVyTGlua0FjdGl2ZT1cImFjdGl2ZVwiPjxlbSBjbGFzcz1cImZhIGZhLWxpc3QtYWx0IGJpIGJpLXRhYmxlXCI+PC9lbT4gVmlldyBEYXRhPC9hPjwvbGk+XHJcbiAgPGxpICpuZ0lmPVwic2VydmljZS5hY3Rpb25BbGxvd2VkKCdmb3JtRWRpdCcpXCIgY2xhc3M9XCJuYXYtaXRlbVwiIHJvdXRlckxpbmtBY3RpdmU9XCJhY3RpdmVcIj48YSBjbGFzcz1cIm5hdi1saW5rXCIgcm91dGVyTGluaz1cImVkaXRcIiByb3V0ZXJMaW5rQWN0aXZlPVwiYWN0aXZlXCI+PGVtIGNsYXNzPVwiZmEgZmEtZWRpdCBiaSBiaS1wZW5jaWwtc3F1YXJlXCI+PC9lbT4gRWRpdCBGb3JtPC9hPjwvbGk+XHJcbiAgPGxpICpuZ0lmPVwic2VydmljZS5hY3Rpb25BbGxvd2VkKCdmb3JtRGVsZXRlJylcIiBjbGFzcz1cIm5hdi1pdGVtXCIgcm91dGVyTGlua0FjdGl2ZT1cImFjdGl2ZVwiPjxhIGNsYXNzPVwibmF2LWxpbmtcIiByb3V0ZXJMaW5rPVwiZGVsZXRlXCIgcm91dGVyTGlua0FjdGl2ZT1cImFjdGl2ZVwiPjxzcGFuIGNsYXNzPVwiZmEgZmEtdHJhc2ggYmkgYmktdHJhc2hcIj48L3NwYW4+PC9hPjwvbGk+XHJcbjwvdWw+XHJcbjxyb3V0ZXItb3V0bGV0Pjwvcm91dGVyLW91dGxldD5cclxuPG5nLXRlbXBsYXRlICNjb250ZW50PlxyXG4gIDxkaXYgY2xhc3M9XCJtb2RhbC1oZWFkZXJcIj5cclxuICAgIDxoNCBjbGFzcz1cIm1vZGFsLXRpdGxlXCI+U2hhcmUgb3IgRW1iZWQgdGhpcyBmb3JtPC9oND5cclxuICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwiY2xvc2VcIiBhcmlhLWxhYmVsPVwiQ2xvc2VcIiAoY2xpY2spPVwibW9kYWxSZWYuaGlkZSgpXCI+XHJcbiAgICAgIDxzcGFuIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPiZ0aW1lczs8L3NwYW4+XHJcbiAgICA8L2J1dHRvbj5cclxuICA8L2Rpdj5cclxuICA8ZGl2IGNsYXNzPVwibW9kYWwtYm9keVwiPlxyXG4gICAgPHVsIGNsYXNzPVwibmF2IG5hdi10YWJzIG1yLWF1dG8gbWItMlwiPlxyXG4gICAgICA8bGkgY2xhc3M9XCJuYXYtaXRlbVwiPlxyXG4gICAgICAgIDxhIGNsYXNzPVwibmF2LWxpbmtcIiBbbmdDbGFzc109XCJ7J2FjdGl2ZSc6IGNob2ljZSA9PT0gJ2lzVXJsJ31cIiAoY2xpY2spPVwiY2hvaWNlcygnaXNVcmwnKVwiPjxlbSBjbGFzcz1cImZhIGZhLWxpbmsgYmkgYmktbGlua1wiPjwvZW0+IFVSTDwvYT5cclxuICAgICAgPC9saT5cclxuICAgICAgPGxpIGNsYXNzPVwibmF2LWl0ZW1cIj5cclxuICAgICAgICA8YSBjbGFzcz1cIm5hdi1saW5rXCIgW25nQ2xhc3NdPVwieydhY3RpdmUnOiBjaG9pY2UgPT09ICdpc0VtYmVkJ31cIiAoY2xpY2spPVwiY2hvaWNlcygnaXNFbWJlZCcpXCI+PGVtIGNsYXNzPVwiZmEgZmEtY29kZSBiaSBiaS1jb2RlLXNsYXNoXCI+PC9lbT4gRW1iZWQ8L2E+XHJcbiAgICAgIDwvbGk+XHJcbiAgICA8L3VsPlxyXG4gICAgPHByZSAgKm5nSWY9XCJjaG9pY2UgPT09ICdpc0VtYmVkJ1wiPjx0ZXh0YXJlYSBvbmNsaWNrPVwidGhpcy5mb2N1cygpO3RoaXMuc2VsZWN0KClcIiByZWFkb25seT1cInJlYWRvbmx5XCIgc3R5bGU9XCJ3aWR0aDoxMDAlO1wiIHJvd3M9XCI4XCIgW25nTW9kZWxdPVwiZW1iZWRDb2RlXCI+PC90ZXh0YXJlYT48L3ByZT5cclxuICAgIDxpbnB1dCAqbmdJZj1cImNob2ljZSA9PT0gJ2lzVXJsJ1wiIHR5cGU9XCJ0ZXh0XCIgb25jbGljaz1cInRoaXMuZm9jdXMoKTt0aGlzLnNlbGVjdCgpXCIgcmVhZG9ubHk9XCJyZWFkb25seVwiIGNsYXNzPVwiZm9ybS1jb250cm9sXCIgW25nTW9kZWxdPVwic2hhcmVVcmxcIiBwbGFjZWhvbGRlcj1cImh0dHBzOi8vZXhhbXBsZXMuZm9ybS5pby9leGFtcGxlXCI+XHJcbiAgPC9kaXY+XHJcbiAgPGRpdiBjbGFzcz1cIm1vZGFsLWZvb3RlclwiPlxyXG4gICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJidG4gYnRuLWxpZ2h0XCIgKGNsaWNrKT1cIm1vZGFsUmVmLmhpZGUoKVwiPkNsb3NlPC9idXR0b24+XHJcbiAgPC9kaXY+XHJcbjwvbmctdGVtcGxhdGU+XHJcbiJdfQ==